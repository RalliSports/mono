// Xbox-style gamertag generator
const adjectives = [
  'Swift',
  'Shadow',
  'Thunder',
  'Blaze',
  'Frost',
  'Void',
  'Phoenix',
  'Dragon',
  'Wolf',
  'Eagle',
  'Tiger',
  'Lion',
  'Bear',
  'Shark',
  'Cobra',
  'Viper',
  'Raven',
  'Hawk',
  'Falcon',
  'Owl',
  'Mystic',
  'Cosmic',
  'Atomic',
  'Neon',
  'Cyber',
  'Digital',
  'Virtual',
  'Quantum',
  'Nova',
  'Star',
  'Moon',
  'Sun',
  'Galaxy',
  'Orbit',
  'Comet',
  'Meteor',
  'Asteroid',
  'Nebula',
  'Pulsar',
  'Quasar',
  'Rapid',
  'Quick',
  'Fast',
  'Speedy',
  'Agile',
  'Nimble',
  'Fleet',
  'Swift',
  'Hasty',
  'Brisk',
  'Silent',
  'Stealth',
  'Hidden',
  'Secret',
  'Covert',
  'Undercover',
  'Invisible',
  'Ghost',
  'Phantom',
  'Specter',
  'Brave',
  'Bold',
  'Courageous',
  'Fearless',
  'Valiant',
  'Heroic',
  'Mighty',
  'Powerful',
  'Strong',
  'Fierce',
  'Wise',
  'Smart',
  'Clever',
  'Brilliant',
  'Genius',
  'Intelligent',
  'Sharp',
  'Quick',
  'Bright',
  'Witty',
];

const nouns = [
  'Warrior',
  'Hunter',
  'Ranger',
  'Knight',
  'Paladin',
  'Mage',
  'Wizard',
  'Sorcerer',
  'Warlock',
  'Priest',
  'Assassin',
  'Ninja',
  'Samurai',
  'Viking',
  'Gladiator',
  'Champion',
  'Hero',
  'Legend',
  'Master',
  'Lord',
  'Commander',
  'Captain',
  'General',
  'Admiral',
  'Colonel',
  'Major',
  'Sergeant',
  'Lieutenant',
  'Officer',
  'Soldier',
  'Pilot',
  'Driver',
  'Racer',
  'Runner',
  'Jumper',
  'Swimmer',
  'Diver',
  'Climber',
  'Explorer',
  'Adventurer',
  'Scientist',
  'Engineer',
  'Technician',
  'Mechanic',
  'Builder',
  'Creator',
  'Designer',
  'Architect',
  'Artist',
  'Musician',
  'Gamer',
  'Player',
  'Pro',
  'Elite',
  'Veteran',
  'Rookie',
  'Newbie',
  'Noob',
  'Legend',
  'Champion',
  'Phoenix',
  'Dragon',
  'Wolf',
  'Eagle',
  'Tiger',
  'Lion',
  'Bear',
  'Shark',
  'Cobra',
  'Viper',
  'Ghost',
  'Shadow',
  'Phantom',
  'Specter',
  'Wraith',
  'Spirit',
  'Soul',
  'Mind',
  'Heart',
  'Soul',
  'Storm',
  'Thunder',
  'Lightning',
  'Blaze',
  'Fire',
  'Flame',
  'Inferno',
  'Volcano',
  'Earthquake',
  'Tsunami',
  'Frost',
  'Ice',
  'Snow',
  'Blizzard',
  'Avalanche',
  'Glacier',
  'Polar',
  'Arctic',
  'Antarctic',
  'Frozen',
];

const suffixes = [
  'X',
  'Z',
  'Q',
  'V',
  'W',
  'Y',
  'K',
  'J',
  'H',
  'G',
  '99',
  '88',
  '77',
  '66',
  '55',
  '44',
  '33',
  '22',
  '11',
  '00',
  'X1',
  'X2',
  'X3',
  'X4',
  'X5',
  'X6',
  'X7',
  'X8',
  'X9',
  'X0',
  'Z1',
  'Z2',
  'Z3',
  'Z4',
  'Z5',
  'Z6',
  'Z7',
  'Z8',
  'Z9',
  'Z0',
  'Pro',
  'Elite',
  'Master',
  'Legend',
  'Veteran',
  'Rookie',
  'Noob',
  'Gamer',
  'Player',
  'Champ',
];

export function generateGamertag(): string {
  const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];
  const noun = nouns[Math.floor(Math.random() * nouns.length)];
  const suffix = suffixes[Math.floor(Math.random() * suffixes.length)];

  // 50% chance to add a random number between 1-999
  const randomNumber =
    Math.random() > 0.5 ? Math.floor(Math.random() * 999) + 1 : null;

  if (randomNumber) {
    return `${adjective}${noun}${randomNumber}`;
  } else {
    return `${adjective}${noun}${suffix}`;
  }
}

// Generate a unique gamertag that's not already taken
export async function generateUniqueGamertag(
  db: any,
  users: any,
): Promise<string> {
  let attempts = 0;
  const maxAttempts = 10;

  while (attempts < maxAttempts) {
    const gamertag = generateGamertag();

    // Check if gamertag already exists
    const existingUser = await db.query.users.findFirst({
      where: (users: any) => users.username === gamertag,
    });

    if (!existingUser) {
      return gamertag;
    }

    attempts++;
  }

  // If we can't find a unique one after max attempts, add a timestamp
  const timestamp = Date.now().toString().slice(-4);
  return `${generateGamertag()}${timestamp}`;
}
